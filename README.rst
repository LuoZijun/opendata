OpenData ( 开放的公共数据 )
=============================

:Date:2015/08/05


.. contents:: 


中国内地移动终端通讯号码
----------------------------------------------

移动终端通讯号码，即在手机、平板电脑、笔记本等无线终端上使用的手机卡、上网卡的一串数字号码。

维基百科: https://zh.wikipedia.org/wiki/中国内地移动终端通讯号码

号码编码
^^^^^^^^^^

中国内地手机卡号以1开头，共11位数，前7位数字通常称为手机号段。
手机号段类似于地区电话区号，但又不完全相同。
2010年11月之前，一般可以从手机号段直接区分城市归属地和运营商。

示例：1XX-YYYY-ZZZZ
    
*   第1~3位数表示电信运营商。
*   第4~7位数表示地区号码(YYYY)。
*   第8~11位数表示客户号码(ZZZZ)。
*   2010年11月，“携号转网”政策在部分地区开始试行，对于成功进行携号转网的用户，手机号段不再能体现其当前所属运营商。



针对中国移动网站提供的信息做几点补充
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

地址: http://www.10086.cn/support/selfservice/help/hb/

**客户号码的组成**

“全球通”数字移动电话客户号码由11位数字组成，其形式为：网号（139/138/137/136/135）+地区识别码（H0H1H2H3）+具体客户号（ABCD）

1.  “139、138、137、136、135”是中国移动通信数字移动电话网的网号。
2.  “H0H1H2H3”是数字移动电话客户入网地的地区识别码。如：“0800、0801”代表入网地是四川成都地区。
3.  ABCD是具体客户号。如某客户的数字移动电话号码为 1390800ABCD，表明该客户是中国移动通信数字移动电话网的成都业务区内客户号为ABCD的客户。详细情况请以当地移动营业厅或10086客户服务电话的最新公告为准。

号段分配
^^^^^^^^^^

中国移动
~~~~~~~~~
中国移动共计19个号段，其中1个TD-LTE 4G号段，3个TD-SCDMA手机号段，TD-SCDMA兼容SIM卡,用户不用强制换成USIM卡就可以直接使用3G功能[2]，1个TD-SCDMA数据卡号段，14个GSM手机号段。

::

    号段  网络  卡类型
    1340~1348[3]    GSM SIM手机卡
    135 GSM SIM手机卡
    136 GSM SIM手机卡
    137 GSM SIM手机卡
    138 GSM SIM手机卡
    139 GSM SIM手机卡
    147 TD-SCDMA/GSM    USIM/SIM数据卡 / 中国移动香港一卡两号储值卡内地号码
    150 GSM SIM手机卡
    151 GSM SIM手机卡
    152 GSM SIM手机卡
    157 TD-SCDMA    USIM无线固话卡
    158 GSM SIM手机卡
    159 GSM SIM手机卡
    178 TD-LTE  USIM手机卡
    182 GSM SIM手机卡
    183 GSM SIM手机卡
    184 GSM SIM手机卡
    187 TD-SCDMA    USIM手机卡
    188 TD-SCDMA    USIM手机卡

中国联通
~~~~~~~~~

中国联通共计9个号段，其中1个FDD-LTE和TD-LTE混合组网4G号段，
2个WCDMA手机号段，1个WCDMA数据卡号段，4个GSM手机号段，
1个混合GSM与WCDMA号段。

::

    号段  网络  卡类型
    130 GSM SIM手机卡
    131 GSM SIM手机卡
    132 GSM SIM手机卡
    145 WCDMA   USIM数据卡
    155 GSM SIM手机卡
    156 GSM/WCDMA   SIM手机卡/中港一卡两号(3G)
    176 FDD-LTE/TD-LTE  USIM手机卡
    185 WCDMA   USIM手机卡
    186 WCDMA   USIM手机卡

中国电信
~~~~~~~~~
中国电信共计7个号段，其中1个FDD-LTE和TD-LTE混合组网4G号段，
3个CDMA2000手机号段，2个CDMA号段，1个卫星手机专用号段。

::

    号段  网络  卡类型
    133 CDMA    UIM手机卡
    1349[4]     卫星手机卡
    153 CDMA    UIM手机卡
    177 FDD-LTE/TD-LTE  USIM手机卡
    180 CDMA2000    UIM手机卡
    181 CDMA2000    UIM手机卡
    189 CDMA2000    UIM手机卡

    *   Note: 1349号段 由中国电信经营，专用于卫星手机。

上网卡
~~~~~~~~

上网卡又称数据卡，14号段为上网卡专属号段，
中国联通上网卡号段为145，中国移动上网卡号段为147。

虚拟运营商
~~~~~~~~~~~

中国内地近20家移动虚拟运营商推出了170号段。

::

    号段  所属运营商（被转售）  卡类型
    1700    中国电信    UIM手机卡
    1705    中国移动    USIM手机卡
    1709    中国联通    USIM手机卡


170号段为虚拟运营商专属号段，170号段的 11 位手机号中前四位用来区分基础运营商，
“1700” 为中国电信的转售号码标识，“1705” 为中国移动，“1709” 为中国联通。


号码归属地查询
^^^^^^^^^^^^^^^^

参见 上面的 `号码编码` 一节, 手机号码中的第4~7位数表示地区号码(YYYY)。

2010年11月之前，一般可以从手机号段直接区分城市归属地和运营商。

2010年11月，“携号转网”政策在部分地区开始试行，对于成功进行携号转网的用户，
手机号段不再能体现其当前所属运营商。

对此，三大通信运营商(电信/联通/移动)都在其官网提供了 号码归属地查询服务。

*   `中国移动提供的号码归属地检索服务 <http://www.10086.cn/support/selfservice/ownership/>`_
*   `中国联通提供的号码归属地检索服务 <http://iservice.10010.com/e3/service/service_belong.html?menuId=000400010003>`_
*   `中国电信提供的号码归属地检索服务 <http://ah.189.cn/support/common/>`_

**中国联通网络检索示例**

.. code:: bash

    curl -X POST -d "number=18602730949&checkCode=null" "http://iservice.10010.com/e3/static/life/callerLocationQuery?_=1438767945817"

**中国移动网络检索示例**
    
.. code:: python
    
    import requests
    import json
    import re
    import random

    # 会话
    s = requests.Session()
    # 获取验证码
    r = s.get("http://www1.10086.cn/jsp/common/image.jsp?r=0.7038094939198345")
    open("verify.jpg", "wb").write(r.content)
    verify_code = "17d688"  # 自己打开 image 图片看哦

    url = "http://www1.10086.cn/service/shop/attributionwithcode.jsp"
    phone_number = 18602730949

    payload = {"pn": phone_number, "verify": verify_code, "callback": "jsoncallback", "_": random.random() }
    r = s.get( url, params=payload, headers=headers );
    body = re.compile(r"jsoncallback\(\n(.*?)\n\)", re.DOTALL).findall(r.text)[0]
    result = json.loads(body)
    print result


截至2015/05/06为止, 中国联通提供的查询服务只可以查询联通运营的号段归属地。
中国移动提供了所有号码的查询服务(但是需要输入验证码)。中国电信的页面似乎存在BUG, 查询接口无法工作( :-( )。
